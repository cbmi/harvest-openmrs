define(["backbone","marionette","jquery","loglevel","./core","./ui"],function(e,t,n,o,i,a){function r(e){e=e||window.event;var t;t=e.type in s?s[e.type]:!this[d],t===!0?i.trigger("visible"):t===!1&&i.trigger("hidden")}i.templates.set(i.config.get("templates",{})),i.controls.set(i.config.get("controls",{}));var c=t.TemplateCache.prototype.loadTemplate,u=t.TemplateCache.prototype.compileTemplate;t.TemplateCache.prototype.loadTemplate=function(e){var t=i.templates.get(e);return t||(t=c.call(this,e)),t},t.TemplateCache.prototype.compileTemplate=function(e){return"function"!=typeof e&&(e=u(e)),e};var l=new a.Notifications({id:"cilantro-notifications"});n("body").append(l.render().el),i.notify=l.notify,n.ajaxPrefilter(function(e){e.xhrFields={withCredentials:!0}}),i.config.get("debug")&&(o.setLevel("debug"),i.on("all",function(){o.info.apply(o.info,[].slice.call(arguments,0))})),n(window).on("beforeunload",function(){return!i.config.get("debug")&&n.hasPendingRequest()?"Wow, you're quick! Your data is being saved. It will only take a moment.":void 0}),n(document).ajaxError(function(e,t,n,o){0===t.status||o||i.notify({timeout:null,dismissable:!1,level:"error",header:"Uh oh.",message:'There is a communication problem with the server. <a href="#" onclick="location.reload()">Refreshing</a> the page may help.'})}),n(document).on("click","a",function(t){if(i.router){var n=this.pathname;"/"!==n.charAt(0)&&(n="/"+n);var o=e.history.root||"/";n.slice(0,o.length)===o&&(n=n.slice(o.length)),i.router.hasRoute(n)&&(t.preventDefault(),i.router.navigate(n,{trigger:!0}))}}),n(document).on("click","[data-route]",function(e){if(i.router){var t=n(e.target).attr("data-route");i.router.isNavigable(t)&&(e.preventDefault(),i.router.navigate(t,{trigger:!0}))}});var d="hidden",s={focus:!0,focusin:!0,pageshow:!0,blur:!1,focusout:!1,pagehide:!1};d in document?document.addEventListener("visibilitychange",r):(d="mozHidden")in document?document.addEventListener("mozvisibilitychange",r):(d="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",r):(d="msHidden")in document?document.addEventListener("msvisibilitychange",r):"onfocusin"in document?document.onfocusin=document.onfocusout=r:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=r});
//# sourceMappingURL=setup.js.map