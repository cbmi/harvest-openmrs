define(["underscore","marionette","../base","../core"],function(e,t,i,o){var n=i.LoadView.extend({align:"left"}),r=t.ItemView.extend({className:"row-fluid",template:"query/item",options:{editable:!1},ui:{owner:".owner",nonOwner:".non-owner",shareCount:".share-count",publicIcon:".public-icon"},events:{"click [data-toggle=delete-query-modal]":"showDeleteQueryModal","click [data-toggle=edit-query-modal]":"showEditQueryModal","click .shared-query-name":"openQuery"},modelEvents:{sync:"render"},initialize:function(){if(this.data={},!(this.data.context=this.options.context))throw new Error("context model required");if(!(this.data.view=this.options.view))throw new Error("view model required")},serializeData:function(){var e=this.model.toJSON();return e.shared_users||(e.shared_users=[]),e.user||(e.user={}),e},openQuery:function(){this.data.view.save("json",this.model.get("view_json")),this.data.context.save("json",this.model.get("context_json"),{reset:!0}),o.router.navigate("results",{trigger:!0})},showEditQueryModal:function(){this.trigger("showEditQueryModal",this.model)},showDeleteQueryModal:function(){this.trigger("showDeleteQueryModal",this.model)},onRender:function(){if(this.options.editable&&this.model.get("public")&&this.ui.publicIcon.removeClass("hidden"),this.model.get("is_owner")){this.ui.nonOwner.hide();var t=e.pluck(this.model.get("shared_users"),"email");this.ui.shareCount.attr("title",t.join("<br>")),this.ui.shareCount.tooltip({html:!0,animation:!1,placement:"right",container:"body"})}else this.ui.owner.hide();this.options.editable||(this.ui.nonOwner.hide(),this.ui.owner.hide())}});return{LoadingQueryItem:n,QueryItem:r}});
//# sourceMappingURL=item.js.map